global_defs {
   router_id "{{ inventory_hostname_short }}"
}
{% for host[0] in groups['k8s_masters'] %}
vrrp_instance 41 {
    state MASTER
    interface ens192
    virtual_router_id 41
    priority 200
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass "{{ keepalived_pass }}"
    }
    virtual_ipaddress {
        "{{ kubernetes_loadbalancer: "192.168.78.10" }}"
    }
}
{% else %}
vrrp_instance 41 {
    state BACKUP
    interface ens192
    virtual_router_id 41
    priority 100
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass "{{ keepalived_pass }}"
    }
    virtual_ipaddress {
        "{{ kubernetes_loadbalancer: "192.168.78.10" }}"
    }
}
{% endfor %}

